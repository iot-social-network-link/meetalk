.casting-background-image
.container
  .row
    .col-sm-2.col-sm-offset-10
      #exit_button
        %button.btn.btn-info{:type => "submit", :onclick => "exit()"}
          .fa.fa-sign-out
          #exit_text
            Exit
  .row
    .col-sm-8.col-sm-offset-4
      = form_tag "/wait", method: "post" do
        %h3
          気になる人を選んでね
        %br
        = radio_button_tag :candidate, @candidates[0].id
        = label_tag :candidate, @candidates[0].name
        %br
        = radio_button_tag :candidate, @candidates[1].id
        = label_tag :candidate, @candidates[1].name
        %br
        = submit_tag "submit"

:javascript
  //-----------------------------------
  // 現在の状態取得ポーリング
  //-----------------------------------
  console.log("ユーザーID：" + gon.user.id);
  //var wait_flag = 1;
  setInterval(function(){
    $.ajax({
      type: "GET",
      url: "/api/v1/vote/",
      data: gon.user.id,
      success: function(res){
        console.log(res);
        if(res.result=="match"){
          if(res.room_id){
            console.log("match");
            location.href = "/message/"+res.room_id;
          }
        }else if(res.result=="unmatch"){
            console.log("unmatch");
            location.href = "/"
        }else if(res.result=="wait"){
            console.log("wait");
        }  
      },
      error: function(e){
        console.log(e);
      }
    });
  },5000);